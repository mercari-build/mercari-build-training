FROM python:3.9.6-alpine

WORKDIR /app

COPY python/requirements.txt /app/requirements.txt
RUN pip3 install -r /app/requirements.txt

# The command here is different from that in alpine
# RUN addgroup -S mercari && adduser -S trainee -G mercari
# # Give user trainee the  right to write
# RUN chown -R trainee:mercari /app
# USER trainee

COPY db /app/db
COPY python/main.py /app/python/main.py
COPY images /app/images

EXPOSE 9000

# 5-5 Change Dockerfile
# CMD [ "python3", "-V"]

# 5-6 API
CMD ["uvicorn", "python.main:app", "--host", "0.0.0.0", "--port", "9000"]
# the host should not be "127.0.0.1"